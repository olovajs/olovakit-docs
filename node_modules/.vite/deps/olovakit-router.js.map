{
  "version": 3,
  "sources": ["../../olovakit-router/dist/index.js"],
  "sourcesContent": ["import {\r\n  createElement,\r\n  setState,\r\n  setEffect,\r\n  createContext,\r\n  setContext,\r\n} from \"olovakit\";\r\n\r\nconst RouterContext = createContext({\r\n  navigate: () => {},\r\n  location: {\r\n    pathname: window.location.pathname,\r\n    search: window.location.search,\r\n  },\r\n  params: {},\r\n});\r\n\r\nfunction getPath() {\r\n  return window.location.pathname;\r\n}\r\n\r\nfunction parseQuery(search) {\r\n  if (!search || search === \"?\") return {};\r\n  return search\r\n    .substring(1)\r\n    .split(\"&\")\r\n    .reduce((params, param) => {\r\n      const [key, value] = param.split(\"=\");\r\n      params[decodeURIComponent(key)] = decodeURIComponent(value || \"\");\r\n      return params;\r\n    }, {});\r\n}\r\n\r\nfunction extractParams(pattern, path) {\r\n  if (!pattern || !path) return null;\r\n\r\n  const params = {};\r\n\r\n  const regexPattern = pattern\r\n    .replace(/:[a-zA-Z0-9_]+/g, \"([^/]+)\")\r\n    .replace(/\\*/g, \"(.*)\");\r\n\r\n  const regex = new RegExp(`^${regexPattern}$`);\r\n  const matches = path.match(regex);\r\n\r\n  if (!matches) return null;\r\n\r\n  const paramNames = (pattern.match(/:[a-zA-Z0-9_]+/g) || []).map((param) =>\r\n    param.substring(1)\r\n  );\r\n\r\n  paramNames.forEach((name, index) => {\r\n    params[name] = matches[index + 1];\r\n  });\r\n\r\n  if (pattern.includes(\"*\") && matches[matches.length - 1]) {\r\n    params.wildcard = matches[matches.length - 1];\r\n  }\r\n\r\n  return params;\r\n}\r\n\r\nfunction Router(props) {\r\n  const routes = props.routes || [];\r\n  const fallback = props.fallback;\r\n\r\n  const [location, setLocation] = setState({\r\n    pathname: window.location.pathname,\r\n    search: window.location.search,\r\n  });\r\n  const [params, setParams] = setState({});\r\n  const [currentElement, setCurrentElement] = setState(null);\r\n\r\n  const navigate = (to, { replace = false } = {}) => {\r\n    if (replace) {\r\n      window.history.replaceState(null, \"\", to);\r\n    } else {\r\n      window.history.pushState(null, \"\", to);\r\n    }\r\n\r\n    setLocation({\r\n      pathname: window.location.pathname,\r\n      search: window.location.search,\r\n    });\r\n  };\r\n\r\n  setEffect(() => {\r\n    const handlePopState = () => {\r\n      setLocation({\r\n        pathname: window.location.pathname,\r\n        search: window.location.search,\r\n      });\r\n    };\r\n\r\n    window.addEventListener(\"popstate\", handlePopState);\r\n    return () => window.removeEventListener(\"popstate\", handlePopState);\r\n  }, []);\r\n\r\n  setEffect(() => {\r\n    const path = location.pathname;\r\n    const queryParams = parseQuery(location.search);\r\n    let foundMatch = false;\r\n\r\n    for (const route of routes) {\r\n      if (!route || !route.path) continue;\r\n\r\n      const routeParams = extractParams(route.path, path);\r\n\r\n      if (routeParams !== null) {\r\n        setParams({ ...routeParams, ...queryParams });\r\n        setCurrentElement(route.element);\r\n        foundMatch = true;\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (!foundMatch) {\r\n      setCurrentElement(\r\n        fallback || createElement(\"div\", null, \"404 - Not Found\")\r\n      );\r\n    }\r\n  }, [location.pathname, location.search, routes, fallback]);\r\n\r\n  return createElement(\r\n    RouterContext.Provider,\r\n    {\r\n      value: {\r\n        navigate,\r\n        location,\r\n        params,\r\n      },\r\n    },\r\n    currentElement\r\n  );\r\n}\r\n\r\nfunction useRouter() {\r\n  return setContext(RouterContext);\r\n}\r\n\r\nfunction Link(props) {\r\n  const { to, children, replace, className, style, ...rest } = props;\r\n  const { navigate } = useRouter();\r\n\r\n  const handleClick = (e) => {\r\n    e.preventDefault();\r\n    navigate(to, { replace });\r\n  };\r\n\r\n  return createElement(\r\n    \"a\",\r\n    {\r\n      href: to,\r\n      onClick: handleClick,\r\n      className,\r\n      style,\r\n      ...rest,\r\n    },\r\n    children\r\n  );\r\n}\r\n\r\nfunction Navigate(props) {\r\n  const { to, replace = false } = props;\r\n  const { navigate } = useRouter();\r\n\r\n  setEffect(() => {\r\n    navigate(to, { replace });\r\n  }, [to, replace]);\r\n\r\n  return null;\r\n}\r\n\r\nfunction Route(props) {\r\n  return null;\r\n}\r\n\r\nfunction Routes(props) {\r\n  const { children, fallback } = props;\r\n\r\n  const routeConfigs = Array.isArray(children) ? children : [children];\r\n\r\n  const routes = routeConfigs\r\n    .filter((child) => child != null)\r\n    .map((child) => {\r\n      if (child && child.type === Route) {\r\n        return child.props;\r\n      }\r\n      return child;\r\n    });\r\n\r\n  return createElement(Router, { routes, fallback });\r\n}\r\n\r\nexport { Router, Route, Routes, Link, Navigate, useRouter };\r\n"],
  "mappings": "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",
  "names": []
}
