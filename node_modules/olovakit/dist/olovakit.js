let rootComponent,rootContainer,previousVDOM,currentComponent;const componentStateMap=new Map,contextProviders=new Map;let currentContextKey=0;const SVG_TAGS=new Set(["svg","path","circle","rect","line","polygon","polyline","ellipse","g","text","defs","filter","mask","marker","pattern","linearGradient","radialGradient","stop","use","clipPath","textPath","tspan","foreignObject"]);class LRUCache{constructor(e){this.maxSize=e,this.cache=new Map,this.keyOrder=[]}get(e){if(this.cache.has(e))return this.keyOrder=this.keyOrder.filter((t=>t!==e)),this.keyOrder.push(e),this.cache.get(e)}set(e,t){if(this.cache.has(e))this.keyOrder=this.keyOrder.filter((t=>t!==e));else if(this.cache.size>=this.maxSize){const e=this.keyOrder.shift();this.cache.delete(e)}return this.cache.set(e,t),this.keyOrder.push(e),t}has(e){return this.cache.has(e)}}const renderCache=new LRUCache(100);function memoizeRender(e,t,n){const r=`${n}-${JSON.stringify(t)}`;if(renderCache.has(r))return renderCache.get(r);const o=e(t);return renderCache.set(r,o)}function createElement(e,t,...n){t=t||{};let r=n.flat(1/0).filter((e=>!0!==e&&!1!==e)).map((e=>null==e?createTextElement(""):"object"==typeof e?e:createTextElement(e)));if(void 0!==t.children){r=(Array.isArray(t.children)?t.children:[t.children]).flat(1/0).filter((e=>!0!==e&&!1!==e)).map((e=>null==e?createTextElement(""):"object"==typeof e?e:createTextElement(e)))}const o={...t};return delete o.children,{type:e,props:{...o,children:r}}}function createTextElement(e){return{type:"TEXT",props:{nodeValue:String(e),children:[]}}}function setState(e){const t=currentComponent,n=t.hookIndex++;if(!t.hooks[n]){const r="function"==typeof e?e():e;t.hooks[n]={state:r}}const r=t.hooks[n];return[r.state,e=>{const t="function"==typeof e?e(r.state):e;if(t!==r.state){const e=()=>{r.state=t};isBatchingUpdates?pendingStateUpdates.push(e):(e(),renderApp())}}]}function setReducer(e,t,n){const[r,o]=o(n?()=>n(t):t);return[r,t=>{o((n=>e(n,t)))}]}function setMemo(e,t){const n=currentComponent,r=n.hookIndex++;if(!n.hooks[r])return n.hooks[r]={value:e(),deps:t},n.hooks[r].value;const o=n.hooks[r];return arraysEqual(o.deps,t)||(o.value=e(),o.deps=t),o.value}function setCallback(e,t){return setMemo((()=>e),t)}function setEffect(e,t){const n=currentComponent,r=n.hookIndex++;n.hooks[r]||(n.hooks[r]={effect:e,deps:null,cleanup:null});const o=n.hooks[r];arraysEqual(o.deps,t)||(o.cleanup&&setTimeout((()=>{"function"==typeof o.cleanup&&o.cleanup()}),0),o.effect=e,o.deps=t,setTimeout((()=>{const t=e();o.cleanup=t}),0))}function createContext(e){const t=currentContextKey++;return{Provider:function(e){const{value:n,children:r}=e;return setEffect((()=>(contextProviders.set(t,n),()=>{contextProviders.get(t)===n&&contextProviders.delete(t)})),[n]),r},Consumer:function(e){return e.children(setContext(this))},_contextId:t,_defaultValue:e}}function setContext(e){return setEffect((()=>()=>{}),[contextProviders.get(e._contextId)]),void 0!==contextProviders.get(e._contextId)?contextProviders.get(e._contextId):e._defaultValue}function setRef(e){const t=currentComponent,n=t.hookIndex++;return t.hooks[n]||(t.hooks[n]={current:e}),t.hooks[n]}function arraysEqual(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Fragment(e){return e.children}function buildVDOM(e,t){if(!e)return null;if(Array.isArray(e))return{type:Fragment,props:{children:e.map(((e,n)=>buildVDOM(e,t.concat(n))))}};try{if("object"!=typeof e)return createTextElement(String(e));if(e.type===Fragment)return{type:Fragment,props:{children:Array.isArray(e.props.children)?e.props.children.map(((e,n)=>buildVDOM(e,t.concat(n)))):[buildVDOM(e.props.children,t.concat(0))]}};if("string"==typeof e.type||"TEXT"===e.type){const n=Array.isArray(e.props.children)?e.props.children.map(((e,n)=>buildVDOM(e,t.concat(n)))):[buildVDOM(e.props.children,t.concat(0))];return{type:e.type,props:{...e.props,children:n}}}if("function"!=typeof e.type)return console.warn("Invalid vdom type:",e),createTextElement("");{const n=t.join(".");let r=componentStateMap.get(n);r||(r={hooks:[],hookIndex:0},componentStateMap.set(n,r)),currentComponent=r,currentComponent.hookIndex=0,currentComponent._pathKey=n,e._pathKey=n;try{const r=e.type.isPure||e.type.name&&e.type.name.startsWith("Memo"),o={...e.props};return buildVDOM(r?memoizeRender(e.type,o,n):e.type(o),t)}catch(e){return console.error("Error rendering component:",e),createElement("div",{className:"error-boundary"},`Component Error: ${e.message}`)}}}catch(t){return console.error("Error in buildVDOM:",t,"for vdom:",e),createElement("div",{className:"error-boundary"},`Rendering Error: ${t.message}`)}}function createDOM(e){if(!e)return document.createComment("empty node");if("TEXT"===e.type)return document.createTextNode(e.props.nodeValue);if(e.type===Fragment){const t=document.createDocumentFragment();return e.props.children.filter((e=>null!=e)).forEach((e=>{const n=createDOM(e);n&&t.appendChild(n)})),t}const t=SVG_TAGS.has(e.type),n=t?document.createElementNS("http://www.w3.org/2000/svg",e.type):document.createElement(e.type);return e.props&&e.props.dangerouslySetInnerHTML?n.innerHTML=e.props.dangerouslySetInnerHTML.__html||"":(applyProps(n,{},e.props,t),e.props.children.filter((e=>null!=e)).forEach((e=>{const t=createDOM(e);t&&n.appendChild(t)}))),e.dom=n,n}function applyProps(e,t={},n={},r=!1){if(e&&"function"==typeof e.setAttribute){if(n.ref&&(n.ref.current=e),n.style)try{const t=n.style;Object.keys(t).forEach((n=>{e.style[n]=t[n]}))}catch(e){console.error("Error applying styles:",e)}if(n.className)try{r?e.setAttribute("class",n.className):e.className=n.className}catch(e){console.error("Error setting className:",e)}if(n.dangerouslySetInnerHTML)e.innerHTML=n.dangerouslySetInnerHTML.__html||"";else{!("value"in n)||"INPUT"!==e.tagName&&"TEXTAREA"!==e.tagName&&"SELECT"!==e.tagName||(e.value=null==n.value?"":n.value),"checked"in n&&"INPUT"===e.tagName&&(e.checked=!!n.checked);for(const[o,s]of Object.entries(n))try{if("children"!==o&&"ref"!==o&&"style"!==o&&"className"!==o&&"dangerouslySetInnerHTML"!==o&&"value"!==o&&"checked"!==o)if(o.startsWith("on")&&"function"==typeof s){const n=o.toLowerCase().substring(2);t[o]&&t[o]!==s&&e.removeEventListener(n,t[o]),e.addEventListener(n,s)}else"function"!=typeof s&&"object"!=typeof s&&(r?e.setAttribute(o,s):o in e?e[o]=s:e.setAttribute(o,s))}catch(e){console.error(`Error setting attribute ${o}:`,e)}}}}function cleanupComponent(e){const t=componentStateMap.get(e);t&&(t.hooks.forEach((e=>{e.cleanup&&"function"==typeof e.cleanup&&e.cleanup()})),componentStateMap.delete(e))}function updateDOM(e,t,n,r=0){if(e&&e.childNodes){if(Array.isArray(t)&&Array.isArray(n)){const o=new Map,s=[];t.forEach(((e,t)=>{e&&e.props&&e.props.key?o.set(e.props.key,t):s.push(t)}));let c=0;return n.forEach(((n,a)=>{if(n&&n.props&&n.props.key&&o.has(n.props.key)){const r=o.get(n.props.key);updateDOM(e,t[r],n,r),t[r]=null}else{const o=s[c++]||r+a;updateDOM(e,t[o],n,o),o<t.length&&(t[o]=null)}})),void t.forEach(((t,n)=>{null!==t&&updateDOM(e,t,null,n)}))}if(t?.type!==Fragment||n?.type!==Fragment){if(n&&"PORTAL"===n.type){const e=n.props.container;if(t&&"PORTAL"===t.type){const e=Math.max(t.props.children.length,n.props.children.length);for(let r=0;r<e;r++)updateDOM(t.props.container,t.props.children[r],n.props.children[r],r)}else n.props.children.forEach(((t,n)=>{updateDOM(e,null,t,n)}))}else if(!t&&n){const t=createDOM(n);t&&(e.childNodes.length<=r?e.appendChild(t):e.insertBefore(t,e.childNodes[r]))}else if(t&&!n){if(e.childNodes[r]&&e.removeChild(e.childNodes[r]),"function"==typeof t.type){const e=t._pathKey;e&&cleanupComponent(e)}}else if(t&&n&&t.type!==n.type){const t=createDOM(n);t&&(r<e.childNodes.length?e.replaceChild(t,e.childNodes[r]):e.appendChild(t))}else if(t&&n)if("TEXT"===n.type){if(r<e.childNodes.length){const o=e.childNodes[r];t.props.nodeValue!==n.props.nodeValue&&(o.nodeValue=n.props.nodeValue),n.dom=o}}else if(r<e.childNodes.length){const o=e.childNodes[r],s=SVG_TAGS.has(n.type);for(const e in t.props)"children"===e||e in n.props||(e.startsWith("on")?o.removeEventListener(e.toLowerCase().substring(2),t.props[e]):"style"===e?o.removeAttribute("style"):"ref"!==e&&o.removeAttribute(e));applyProps(o,t.props,n.props,s);const c=Math.max(t.props.children.length,n.props.children.length);for(let e=0;e<c;e++)updateDOM(o,t.props.children[e],n.props.children[e],e);n.dom=o}}else{const o=Math.max(t.props.children.length,n.props.children.length);for(let s=0;s<o;s++)updateDOM(e,t.props.children[s],n.props.children[s],r+s)}}else console.warn("Invalid parent DOM in updateDOM:",e)}function debounce(e,t){let n;return function(...r){clearTimeout(n),n=setTimeout((()=>{clearTimeout(n),e(...r)}),t)}}let renderQueued=!1;function render(e,t){rootComponent=e,rootContainer=t,renderApp()}let concurrentMode=!1,workInProgressRoot=null,currentPriority=0;const PRIORITY={IMMEDIATE:99,USER_BLOCKING:98,NORMAL:97,LOW:96,IDLE:95};function enableConcurrentMode(){concurrentMode=!0}function scheduleWork(e,t=PRIORITY.NORMAL){concurrentMode?(currentPriority=t,t===PRIORITY.IMMEDIATE?e():t===PRIORITY.USER_BLOCKING?setTimeout(e,0):t===PRIORITY.NORMAL?setTimeout(e,10):t===PRIORITY.LOW?setTimeout(e,100):t===PRIORITY.IDLE&&(requestIdleCallback?requestIdleCallback(e):setTimeout(e,500))):e()}const renderApp=debounce((()=>{if(renderQueued)return;renderQueued=!0;const e=()=>{try{renderQueued=!1;const e=buildVDOM("object"==typeof rootComponent&&rootComponent.type?rootComponent:createElement(rootComponent,null),[]);if(updateDOM(rootContainer,previousVDOM,e),previousVDOM=e,pendingStateUpdates.length>0){const e=[...pendingStateUpdates];pendingStateUpdates.length=0,e.forEach((e=>e())),renderApp()}}catch(e){console.error("Error during render:",e),renderQueued=!1}};concurrentMode?scheduleWork(e,currentPriority||PRIORITY.NORMAL):queueMicrotask(e)}),16);function memo(e,t){function n(n){const r=currentComponent,o=r.hookIndex++;if(r.hooks[o]){const s=r.hooks[o];(t?!t(s.props,n):!shallowEqual(s.props,n))&&(s.props=n,s.result=e(n))}else r.hooks[o]={props:n,result:e(n),memoized:!0};return r.hooks[o].result}return n.displayName=`Memo(${e.displayName||e.name||"Component"})`,n.isPure=!0,n}function shallowEqual(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(let r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!Object.is(e[n[r]],t[n[r]]))return!1;return!0}function createRoot(e){return{render:t=>{enableConcurrentMode(),render(t,e)},unmount:()=>{for(;e.firstChild;)e.removeChild(e.firstChild);componentStateMap.forEach(((e,t)=>{cleanupComponent(t)})),rootComponent=null,rootContainer=null,previousVDOM=null}}}let isBatchingUpdates=!1;const pendingStateUpdates=[];function batchUpdates(e){const t=isBatchingUpdates;isBatchingUpdates=!0;try{e()}finally{if(isBatchingUpdates=t,!isBatchingUpdates&&pendingStateUpdates.length>0){const e=[...pendingStateUpdates];pendingStateUpdates.length=0,e.forEach((e=>e())),renderApp()}}}"undefined"!=typeof window&&(window.Fragment=Fragment,window.createElement=createElement);export{render,setState,setEffect,setReducer,setMemo,setCallback,setRef,setContext,createElement,createTextElement,createContext,Fragment,memo,createRoot,enableConcurrentMode,batchUpdates};